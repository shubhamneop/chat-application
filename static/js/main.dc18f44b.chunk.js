(this["webpackJsonpchat-application"]=this["webpackJsonpchat-application"]||[]).push([[0],{121:function(e,t,a){},131:function(e,t,a){"use strict";a.r(t);var n=a(3),s=a.n(n),c=a(36),i=a.n(c),r=(a(78),a(79),a(9)),o=a(16),l=a(48),u=a(13),d=a(17),j=a(34),m=(a(87),a(88),(0===j.a.apps.length?j.a.initializeApp({apiKey:"AIzaSyAzMY23pgK5RByUNpZW_Z0Ucizjue6hBHs",authDomain:"signal-clone-f67cf.firebaseapp.com",projectId:"signal-clone-f67cf",storageBucket:"signal-clone-f67cf.appspot.com",messagingSenderId:"672379238512",appId:"1:672379238512:web:4ecfc0de98be2a4f729cb5",measurementId:"G-KSVPRWY1VX"}):j.a.app()).firestore()),b=j.a.auth(),h="LOGIN",p="REGISTER",g="LOGOUT",f="SENDMESSAGE",O="GETMESSAGE",v="USERS",x="INIT",y=(a(89),a(2)),N=function(){return Object(y.jsx)("div",{className:"Loader",children:"Loading..."})};var w=Object(u.b)((function(e){return{loading:e.loading,isLogin:e.isLogin}}))(Object(r.g)((function(e){var t=Object(n.useState)({}),a=Object(l.a)(t,2),s=a[0],c=a[1],i=e.loading,r=e.history,u=e.dispatch;Object(n.useEffect)((function(){localStorage.token&&r.push("/")}),[r]),Object(n.useEffect)((function(){var e=setTimeout((function(){var e={};s.email?/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(s.email)||(e.email="Plaese enter valid email"):e.email="Plaese enter email",s.password||(e.password="Plaese enter password"),e&&g(e)}),500),t=b.onAuthStateChanged((function(e){console.log("auth user",e),e&&(u({type:h,payload:e}),r.replace("/"))}));return function(){clearTimeout(e),t()}}),[s]);var j=Object(n.useState)({}),m=Object(l.a)(j,2),p=m[0],g=m[1];return Object(y.jsx)(y.Fragment,{children:i?Object(y.jsx)(N,{}):Object(y.jsxs)("form",{id:"loginform",className:"custom-form",children:[Object(y.jsx)("h2",{style:{textAlign:"center"},children:"Login"}),Object(y.jsxs)("div",{className:"form-group",children:[Object(y.jsx)("label",{children:"Email"}),Object(y.jsx)("input",{type:"email",name:"email",className:"form-control",onChange:function(e){c(Object(o.a)(Object(o.a)({},s),{},{email:e.target.value}))}}),Object(y.jsx)("span",{style:{color:"red"},children:null===p||void 0===p?void 0:p.email})]}),Object(y.jsxs)("div",{className:"form-group",children:[Object(y.jsx)("label",{children:"Password"}),Object(y.jsx)("input",{type:"password",name:"password",className:"form-control",onChange:function(e){c(Object(o.a)(Object(o.a)({},s),{},{password:e.target.value}))}}),Object(y.jsx)("span",{style:{color:"red"},children:null===p||void 0===p?void 0:p.password})]}),Object(y.jsx)("button",{className:"btn btn-primary",onClick:function(e){e.preventDefault();var t=function(e){var t={};e.email.value?e.email.value&&(/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e.email.value)||(t.email="Plaese enter valid email")):t.email="Plaese enter email";return e.password.value||(t.password="Plaese enter password"),Object.keys(t).length>0&&t}(document.getElementById("loginform").elements);t?g(t):(g({}),console.log("user",s),u({type:x}),b.signInWithEmailAndPassword(s.email,s.password).then((function(e){u({type:h,payload:e.user})})).catch((function(e){return alert(e.message)})))},children:"Login"}),Object(y.jsx)("br",{}),Object(y.jsx)("br",{}),Object(y.jsx)("div",{style:{float:"left"},children:Object(y.jsx)(d.b,{to:"/register",children:"New User? Click here"})}),Object(y.jsx)("br",{})]})})}))),L=a(68),z=a(69),S=a(73),E=a(72),k=function(e){Object(S.a)(a,e);var t=Object(E.a)(a);function a(){var e;return Object(L.a)(this,a),(e=t.call(this)).user={},e.getEmail=function(t){e.user.email=t.target.value},e.getPass=function(t){e.user.password=t.target.value},e.getName=function(t){e.user.name=t.target.value},e.validate=function(e){var t={};if(e.email.value){if(e.email.value){/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e.email.value)||(t.email="Plaese enter valid email")}}else t.email="Plaese enter email";return e.name.value||(t.name="Plaese enter name"),e.password.value||(t.password="Plaese enter password"),Object.keys(t).length>0&&t},e.submit=function(t){t.preventDefault();var a=document.getElementById("signupform"),n=e.validate(a.elements);n?e.setState({errorMessage:n}):b.createUserWithEmailAndPassword(e.user.email,e.user.password).then((function(t){t.user.updateProfile({displayName:e.user.name,photoURL:"https://cencup.com/wp-content/uploads/2019/07/avatar-placeholder.png"}),m.collection("users").doc(b.currentUser.uid).set({id:b.currentUser.uid,name:e.user.name,email:e.user.email,photoURL:"https://cencup.com/wp-content/uploads/2019/07/avatar-placeholder.png"})})).catch((function(e){return alert(e.message)}))},e.state={},e}return Object(z.a)(a,[{key:"componentDidMount",value:function(){var e=this;b.onAuthStateChanged((function(t){console.log("auth user",t),t&&e.props.history.replace("/")}))}},{key:"render",value:function(){var e,t,a,n=this.props.loading;return Object(y.jsx)(y.Fragment,{children:n?Object(y.jsx)(N,{}):Object(y.jsxs)("form",{id:"signupform",className:"custom-form",children:[Object(y.jsx)("h2",{style:{textAlign:"center"},children:"Sign Up"}),Object(y.jsxs)("div",{className:"form-group",children:[Object(y.jsx)("label",{children:"Email"}),Object(y.jsx)("input",{type:"email",name:"email",className:"form-control",onChange:this.getEmail}),Object(y.jsx)("span",{style:{color:"red"},children:null===(e=this.state.errorMessage)||void 0===e?void 0:e.email})]}),Object(y.jsxs)("div",{className:"form-group",children:[Object(y.jsx)("label",{children:"Name"}),Object(y.jsx)("input",{type:"text",name:"name",className:"form-control",onChange:this.getName}),Object(y.jsx)("span",{style:{color:"red"},children:null===(t=this.state.errorMessage)||void 0===t?void 0:t.name})]}),Object(y.jsxs)("div",{className:"form-group",children:[Object(y.jsx)("label",{children:"Password"}),Object(y.jsx)("input",{type:"password",name:"password",className:"form-control",onChange:this.getPass}),Object(y.jsx)("span",{style:{color:"red"},children:null===(a=this.state.errorMessage)||void 0===a?void 0:a.password})]}),Object(y.jsx)("button",{className:"btn btn-primary",onClick:this.submit,children:"Signup"}),Object(y.jsx)("br",{}),Object(y.jsx)("div",{style:{float:"left"},children:Object(y.jsx)(d.b,{to:"/login",children:"Have a account? Click here"})}),Object(y.jsx)("br",{})]})})}}]),a}(s.a.Component),U=Object(r.g)(k),P=(a(92),a(70)),C=a.n(P)()("https://shubhamsocket.herokuapp.com"),A=Object(u.b)((function(e){return{users:e.users}}))(Object(r.g)((function(e){var t=e.users,a=e.dispatch;Object(n.useEffect)((function(){return m.collection("users").onSnapshot((function(e){var t;t=e.docs.filter((function(e){var t;return e.id!==(null===(t=b.currentUser)||void 0===t?void 0:t.uid)})).map((function(e){return{id:e.id,data:e.data()}})),a({type:v,payload:t})}))}),[]),Object(n.useEffect)((function(){C.on("FromAPI",(function(e){}))}),[C]);return Object(y.jsx)(y.Fragment,{children:Object(y.jsx)("div",{className:"container",children:Object(y.jsx)("ul",{className:"main",children:t.length>0&&t.map((function(t){var a=t.id,n=t.data,s=n.name,c=n.photoURL;return Object(y.jsxs)("li",{onClick:function(){return function(t){e.history.push("/chat/"+t)}(a)},className:"item ",children:[Object(y.jsx)("img",{src:c,width:"50px",height:"50px"})," ",s]},a)}))})})})})));a(121);var I=Object(u.b)((function(e){return{users:e.users,isLogin:e.isLogin,messages:e.messages}}))(Object(r.g)((function(e){var t,a=Object(r.f)(),s=e.users,c=e.messages,i=e.isLogin,o=e.dispatch,l=e.history,u=function(){var e,t=null===(e=b.currentUser)||void 0===e?void 0:e.uid,n=a.id,s=[];return s.push(t),s.push(n),s.sort(),s.join("_")};Object(n.useEffect)((function(){C.emit("join",u()),C.on("chat",(function(e){o({type:O,payload:e})}))}),[]),Object(n.useEffect)((function(){i||l.push("/login")}),[i]);var d=s.length>0?s.find((function(e){return e.id===a.id})).data:null;return Object(y.jsxs)("div",{className:"container",children:[Object(y.jsxs)("div",{className:"item",children:[Object(y.jsx)("img",{src:null===d||void 0===d?void 0:d.photoURL,width:"50px",height:"50px",style:{borderRadius:"50%"}}),Object(y.jsx)("h3",{children:null===d||void 0===d?void 0:d.name}),Object(y.jsx)("button",{onClick:function(){return l.push("/")},className:"btn btn-outline-info btn-sm my-2 my-sm-0",children:"Back"})]}),Object(y.jsx)("div",{className:"main-chat",children:c.filter((function(e){return e.room_id===u()})).map((function(e){var t,a=e.id,n=e.data;return n.email===(null===b||void 0===b||null===(t=b.currentUser)||void 0===t?void 0:t.email)?Object(y.jsxs)("div",{className:"reciver",children:[Object(y.jsx)("img",{style:{position:"absolute",bottom:-15,right:-5,width:"30px",height:"30px"},position:"absolute",bottom:-15,right:-5,src:n.photoURL}),Object(y.jsx)("p",{className:"recieverText",children:n.message})]},a):Object(y.jsxs)("div",{className:"sender",children:[Object(y.jsx)("img",{style:{position:"absolute",bottom:-15,left:-5,width:"30px",height:"30px"},position:"absolute",bottom:-15,left:-5,src:n.photoURL}),Object(y.jsx)("p",{className:"senderText",children:n.message}),Object(y.jsx)("p",{className:"senderName",children:n.displayName})]},a)}))}),Object(y.jsxs)("div",{className:"footer",children:[Object(y.jsx)("input",{className:"form-control textIput",placeholder:" Message...",type:"text",ref:function(e){return t=e}}),Object(y.jsx)("button",{className:"btn btn-outline-success my-2 my-sm-0",onClick:function(e){!function(e){var a,n,s,c;e.preventDefault();var i=u(),r={id:Math.random().toString(),room_id:i,data:{email:null===(a=b.currentUser)||void 0===a?void 0:a.email,displayName:null===(n=b.currentUser)||void 0===n?void 0:n.displayName,message:null===(s=t)||void 0===s?void 0:s.value,photoURL:null===(c=b.currentUser)||void 0===c?void 0:c.photoURL}};C.emit("chat",{message:r,room:i})}(e),t.value=""},children:"Send"})]})]})})));var R=Object(u.b)((function(e){return console.log(e),{loading:e.loading,isLogin:e.isLogin}}))(Object(r.g)((function(e){var t,a;return Object(y.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark",children:[Object(y.jsxs)(d.c,{className:"nav-link",to:"/",children:["EGLR"," ",(null===(t=b.currentUser)||void 0===t?void 0:t.displayName)?"(".concat(null===(a=b.currentUser)||void 0===a?void 0:a.displayName,")"):""]}),Object(y.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(y.jsx)("span",{className:"navbar-toggler-icon"})}),Object(y.jsx)("div",{className:"collapse navbar-collapse",id:"navbarText",children:Object(y.jsxs)("ul",{className:"navbar-nav mr-auto",children:[Object(y.jsx)("li",{className:"nav-item",children:Object(y.jsx)(d.c,{className:"nav-link",to:"/",exact:!0,children:"Home"})}),e.isLogin?Object(y.jsx)("li",{className:"nav-item",children:Object(y.jsx)("button",{className:"btn btn-outline-success my-2 my-sm-0",type:"submit",onClick:function(){b.signOut().then((function(){e.dispatch({type:g}),setTimeout((function(){e.history.push("/login")}),1e3)}))},children:"Logout"})}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("li",{className:"nav-item",children:Object(y.jsx)(d.c,{className:"nav-link",to:"/login",exact:!0,children:"Login"})}),Object(y.jsx)("li",{className:"nav-item",children:Object(y.jsx)(d.c,{className:"nav-link",to:"/register",exact:!0,children:"Register"})})]})]})})]})})));var T=Object(u.b)((function(e){return{isLogin:e.isLogin}}))((function(e){var t=Object(u.c)();return Object(n.useEffect)((function(){return b.onAuthStateChanged((function(e){e&&t({type:h,payload:e})}))}),[]),Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(R,{}),Object(y.jsxs)(r.c,{children:[Object(y.jsx)(r.a,{path:"/",exact:!0,children:e.isLogin?Object(y.jsx)(A,{}):Object(y.jsx)(w,{})}),Object(y.jsx)(r.a,{path:"/login",exact:!0,children:Object(y.jsx)(w,{})}),Object(y.jsx)(r.a,{path:"/register",exact:!0,children:Object(y.jsx)(U,{})}),Object(y.jsx)(r.a,{path:"/chat/:id",exact:!0,children:Object(y.jsx)(I,{})})]})]})})),M=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,132)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,i=t.getTTFB;a(e),n(e),s(e),c(e),i(e)}))},_=(a(122),a(123),a(130),a(50));var F=a(71),B=a(49),G={isLogin:!1,user:null,messages:[],users:[],loading:!1},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return(e=Object(o.a)({},e)).loading=!0,e;case h:return(e=Object(o.a)({},e)).isLogin=!0,e.user=t.payload,e.loading=!1,e;case p:return(e=Object(o.a)({},e)).isLogin=!0,e.user=t.payload,e;case f:return(e=Object(o.a)({},e)).messages=[].concat(Object(B.a)(e.messages),[t.payload]),e;case O:e=Object(o.a)({},e);var a,n=[].concat(Object(B.a)(e.messages),[t.payload]),s=[],c=new Map,i=Object(F.a)(n);try{for(i.s();!(a=i.n()).done;){var r=a.value;c.has(r.id)||(c.set(r.id,!0),s.push({id:r.id,room_id:r.room_id,data:r.data}))}}catch(l){i.e(l)}finally{i.f()}return e.messages=s,e;case v:return(e=Object(o.a)({},e)).users=t.payload,e;case g:return(e=Object(o.a)({},e)).user=null,e.isLogin=!1,e.loading=!1,e.messages=[],e.users=[],e;default:return e}},$=Object(_.a)((function(e){return function(t){return function(a){console.log("Before Action ",a.type,e.getState());var n=t(a);return console.log("After Action ",a.type,e.getState()),n}}})),W=Object(_.b)(D,$);i.a.render(Object(y.jsx)(s.a.StrictMode,{children:Object(y.jsx)(u.a,{store:W,children:Object(y.jsx)(d.a,{basename:"/chat-application/",children:Object(y.jsx)(T,{})})})}),document.getElementById("root")),M()},78:function(e,t,a){},79:function(e,t,a){},89:function(e,t,a){},92:function(e,t,a){}},[[131,1,2]]]);
//# sourceMappingURL=main.dc18f44b.chunk.js.map